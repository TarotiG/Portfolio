@page
@using System.Text.Encodings.Web
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}
<section id="projects" class="py-16 bg-blue-100">
    <div class="max-w-6xl mx-auto px-6">
        <h3 class="text-gray-600 text-3xl font-semibold mb-8 text-center">📁 Uitgelichte projecten</h3>

        <!-- Project Grid -->
        <div id="list-projecten" class="grid md:grid-cols-2 gap-8 transition-all duration-500">
            @foreach (var project in Model.Projecten)
            {
                var nameProj = JavaScriptEncoder.Default.Encode(project.Name);
                var descriptionProj = JavaScriptEncoder.Default.Encode(project.Description);
                var technologiesProj = string.Join(", ", project.Technologies.SelectMany(pt => pt.TechnologyName));
                var technologiesEncoded = JavaScriptEncoder.Default.Encode(technologiesProj);
                var startperiodProj = JavaScriptEncoder.Default.Encode(project.StartDate.ToString());
                var endPeriodProj = JavaScriptEncoder.Default.Encode(project.EndDate.ToString());

                <div class="project-card bg-blue-200 p-6 rounded-lg shadow-md transition-all duration-300">
                    <h4 class="text-xl font-bold">@project.Name</h4>
                    <p class="text-black mt-2">@project.Description</p>
                    <a href="#"
                       class="text-black hover:underline mt-2 inline-block"
                       onclick="showProjectDetail('@nameProj', '@descriptionProj', '@technologiesEncoded', '@startperiodProj', '@endPeriodProj'); return false;">
                        Bekijk project →
                    </a>
                </div>
            }
        </div>

        <!-- Project Detail Section (verborgen by default) -->
        <div id="project-detail" class="hidden mt-8">
            <div class="bg-blue-100 rounded-lg shadow-lg overflow-hidden transform transition-all duration-500">
                <!-- Header met project naam -->
                <div class="bg-blue-200 p-6 border-b border-gray-700">
                    <h4 id="project-name" class="text-3xl font-bold text-black"></h4>
                </div>

                <!-- Content sectie -->
                <div class="p-8">
                    <!-- Beschrijving -->
                    <div class="mb-8">
                        <h5 class="text-sm font-semibold text-gray-600 uppercase tracking-wider mb-3">Beschrijving</h5>
                        <p id="project-desc" class="text-gray-600 text-lg leading-relaxed"></p>
                    </div>

                    <!-- Details grid -->
                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <!-- Technologie -->
                        <div class="bg-blue-200 p-4 rounded-lg">
                            <h5 class="text-sm font-semibold text-gray-600 uppercase tracking-wider mb-2">Technologie</h5>
                            <p id="project-technology" class="text-gray-600 font-medium"></p>
                        </div>

                        <!-- Periode -->
                        <div class="bg-blue-200 p-4 rounded-lg">
                            <h5 class="text-sm font-semibold text-gray-600 uppercase tracking-wider mb-2">Periode</h5>
                            <p id="project-period" class="text-gray-600 font-medium"></p>
                        </div>
                    </div>

                    <!-- Exit button -->
                    <div class="pt-4 border-t border-gray-700">
                        <a href="#"
                           onclick="exitProject(); return false;"
                           class="inline-flex items-center text-blue-400 hover:text-blue-300 font-medium transition-colors">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                            </svg>
                            Terug naar projecten
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script>
            function showProjectDetail(name, description, technology, startPeriod, endPeriod) {
            console.log(technology);
            // Vul detail informatie
            document.getElementById('project-name').textContent = name;
            document.getElementById('project-desc').textContent = description;
            document.getElementById('project-technology').textContent = 'Technology: ' + technology;
            document.getElementById('project-period').textContent = 'Period: ' + startPeriod + ' - ' + endPeriod;

            // Verberg grid met fade
            const listProjecten = document.getElementById('list-projecten');
            listProjecten.classList.add('hidden');

            // Wacht tot fade out compleet is, dan toon detail
            setTimeout(() => {
                const detailSection = document.getElementById('project-detail');
                detailSection.classList.remove('hidden');

                // Force reflow voor animatie
                detailSection.offsetHeight;

                detailSection.classList.add('show');

                // Smooth scroll naar detail
                setTimeout(() => {
                    detailSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            }, 300);
        }

        function exitProject() {
            const detailSection = document.getElementById('project-detail');
            const listProjecten = document.getElementById('list-projecten');

            // Fade out detail
            detailSection.classList.remove('show');

            // Scroll eerst terug naar projecten sectie (tijdens fade out)
            document.getElementById('projects').scrollIntoView({ behavior: 'smooth', block: 'start' });

            // Wacht tot animatie klaar is
            setTimeout(() => {
                detailSection.classList.add('hidden');

                // Toon grid weer met fade in
                listProjecten.classList.remove('hidden');
            }, 500);
        }
    </script>
}